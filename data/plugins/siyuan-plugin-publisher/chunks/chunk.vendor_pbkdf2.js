import{c as a}from"./chunk.vendor_asn1-js.js";import{r as I}from"./chunk.vendor_safe-buffer.js";import{p as W}from"./chunk.vendor_vite-plugin-node-polyfills.js";import{a as Y}from"./chunk.vendor_create-hash.js";import{r as k}from"./chunk.vendor_ripemd160.js";import{r as rr}from"./chunk.vendor_sha-js.js";import{r as er}from"./chunk.vendor_to-buffer.js";var S={},U,C;function j(){if(C)return U;C=1;var u=isFinite,p=Math.pow(2,30)-1;return U=function(h,o){if(typeof h!="number")throw new TypeError("Iterations not a number");if(h<0||!u(h))throw new TypeError("Bad iterations");if(typeof o!="number")throw new TypeError("Key length not a number");if(o<0||o>p||o!==o)throw new TypeError("Bad key length")},U}var x,N;function G(){if(N)return x;N=1;var u;if(a.process&&a.process.browser)u="utf-8";else if(a.process&&a.process.version){var p=parseInt(W.version.split(".")[0].slice(1),10);u=p>=6?"utf-8":"binary"}else u="utf-8";return x=u,x}var z,O;function X(){if(O)return z;O=1;var u=I().Buffer,p=er(),h=typeof Uint8Array<"u",o=h&&typeof ArrayBuffer<"u",l=o&&ArrayBuffer.isView;return z=function(s,v,y){if(typeof s=="string"||u.isBuffer(s)||h&&s instanceof Uint8Array||l&&l(s))return p(s,v);throw new TypeError(y+" must be a string, a Buffer, a Uint8Array, or a DataView")},z}var F,V;function J(){if(V)return F;V=1;var u=Y(),p=k(),h=rr(),o=I().Buffer,l=j(),s=G(),v=X(),y=o.alloc(128),w={__proto__:null,md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,"sha512-256":32,ripemd160:20,rmd160:20},d={__proto__:null,"sha-1":"sha1","sha-224":"sha224","sha-256":"sha256","sha-384":"sha384","sha-512":"sha512","ripemd-160":"ripemd160"};function b(r){return new p().update(r).digest()}function A(r){function e(t){return h(r).update(t).digest()}return r==="rmd160"||r==="ripemd160"?b:r==="md5"?u:e}function q(r,e,t){var c=A(r),n=r==="sha512"||r==="sha384"?128:64;e.length>n?e=c(e):e.length<n&&(e=o.concat([e,y],n));for(var i=o.allocUnsafe(n+w[r]),m=o.allocUnsafe(n+w[r]),f=0;f<n;f++)i[f]=e[f]^54,m[f]=e[f]^92;var B=o.allocUnsafe(n+t+4);i.copy(B,0,0,n),this.ipad1=B,this.ipad2=i,this.opad=m,this.alg=r,this.blocksize=n,this.hash=c,this.size=w[r]}q.prototype.run=function(r,e){r.copy(e,this.blocksize);var t=this.hash(e);return t.copy(this.opad,this.blocksize),this.hash(this.opad)};function P(r,e,t,c,n){l(t,c),r=v(r,s,"Password"),e=v(e,s,"Salt");var i=(n||"sha1").toLowerCase(),m=d[i]||i,f=w[m];if(typeof f!="number"||!f)throw new TypeError("Digest algorithm not supported: "+n);var B=new q(m,r,e.length),K=o.allocUnsafe(c),_=o.allocUnsafe(e.length+4);e.copy(_,0,0,e.length);for(var L=0,T=f,Q=Math.ceil(c/T),D=1;D<=Q;D++){_.writeUInt32BE(D,e.length);for(var H=B.run(_,B.ipad1),R=H,g=1;g<t;g++){R=B.run(R,B.ipad2);for(var E=0;E<T;E++)H[E]^=R[E]}H.copy(K,L),L+=T}return K}return F=P,F}var M,$;function nr(){if($)return M;$=1;var u=I().Buffer,p=j(),h=G(),o=J(),l=X(),s,v=a.crypto&&a.crypto.subtle,y={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},w=[],d;function b(){return d||(a.process&&a.process.nextTick?d=a.process.nextTick:a.queueMicrotask?d=a.queueMicrotask:a.setImmediate?d=a.setImmediate:d=a.setTimeout,d)}function A(r,e,t,c,n){return v.importKey("raw",r,{name:"PBKDF2"},!1,["deriveBits"]).then(function(i){return v.deriveBits({name:"PBKDF2",salt:e,iterations:t,hash:{name:n}},i,c<<3)}).then(function(i){return u.from(i)})}function q(r){if(a.process&&!a.process.browser||!v||!v.importKey||!v.deriveBits)return Promise.resolve(!1);if(w[r]!==void 0)return w[r];s=s||u.alloc(8);var e=A(s,s,10,128,r).then(function(){return!0},function(){return!1});return w[r]=e,e}function P(r,e){r.then(function(t){b()(function(){e(null,t)})},function(t){b()(function(){e(t)})})}return M=function(r,e,t,c,n,i){if(typeof n=="function"&&(i=n,n=void 0),p(t,c),r=l(r,h,"Password"),e=l(e,h,"Salt"),typeof i!="function")throw new Error("No callback provided to pbkdf2");n=n||"sha1";var m=y[n.toLowerCase()];if(!m||typeof a.Promise!="function"){b()(function(){var f;try{f=o(r,e,t,c,n)}catch(B){i(B);return}i(null,f)});return}P(q(m).then(function(f){return f?A(r,e,t,c,m):o(r,e,t,c,n)}),i)},M}var Z;function cr(){return Z||(Z=1,S.pbkdf2=nr(),S.pbkdf2Sync=J()),S}export{cr as r};
